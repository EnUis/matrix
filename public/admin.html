<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Matrix ‚Ä¢ Admin</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="ui.css" />
  <link rel="stylesheet" href="admin.css" />
</head>

<body>
  <header class="admin-header">
    <div class="container inner">
      <div style="display:flex; align-items:center; gap:12px;">
        <div class="admin-title">MATRIX ADMIN</div>
        <a class="btn ghost" href="/">Back to Leaderboard</a>
      </div>

      <div style="display:flex; align-items:center; gap:10px;">
        <div id="healthPill" class="pill">Checking‚Ä¶</div>
        <button id="logoutBtn" class="btn danger" style="display:none;" type="button">Logout</button>
      </div>
    </div>
  </header>

  <main class="container admin-main">
    <!-- LOGIN -->
    <div id="loginView" class="login-wrap">
      <div class="card borderGlow login-card">
        <div class="login-head">
          <div class="section-title">üîê Admin Login</div>
          <div class="kbd">Enter ‚Üµ</div>
        </div>

        <div class="hr"></div>

        <div class="row">
          <input id="pass" class="input" type="password" placeholder="Enter admin password" />
          <button id="loginBtn" class="btn primary" type="button">Login</button>
        </div>

        <div id="loginMsg" class="msg error"></div>

        <div class="muted small" style="margin-top:10px; line-height:1.6;">
          Tip: sessions are stored in MongoDB, so refresh won‚Äôt log you out until the session expires.
        </div>
      </div>
    </div>

    <!-- PANEL -->
    <div id="panelView" style="display:none;">
      <section class="grid">
        <!-- ADD -->
        <div class="card borderGlow card-pad">
          <div class="section-title">‚ûï Add Player</div>
          <div class="muted small" style="margin-top:6px; line-height:1.6;">
            Type FACEIT nickname (or a player ID UUID). We store the permanent FACEIT ID so nickname changes won‚Äôt break the list.
          </div>

          <div class="row" style="margin-top:12px;">
            <input id="nick" class="input" placeholder="FACEIT nickname or player ID (UUID)" />
            <button id="lookupBtn" class="btn" type="button">Preview</button>
            <button id="addBtn" class="btn primary" type="button">Add</button>
          </div>

          <div id="preview" class="preview">
            <img id="prevAv" class="avatar" alt="" />
            <div style="min-width:0;">
              <div id="prevName" class="p-name">Preview will appear here</div>
              <div class="p-meta">
                <span id="prevElo" class="pill">ELO: -</span>
                <span id="prevLvl" class="pill">LVL: -</span>
                <span id="prevId" class="pill">ID: -</span>
              </div>
            </div>
          </div>

          <div id="addMsg" class="msg error"></div>
          <div id="addOk" class="msg ok"></div>
        </div>

        <!-- TIPS -->
        <div class="card card-pad">
          <div class="section-title">üìå Tips</div>
          <div class="muted small" style="margin-top:10px; line-height:1.8;">
            ‚Ä¢ Make sure FACEIT_API_KEY is set in your .env.<br>
            ‚Ä¢ Use Preview before adding to verify the player.<br>
            ‚Ä¢ Use search in the list to remove quickly.
          </div>

          <div class="hr"></div>

          <div class="muted small">
            If login fails, confirm your .env has ADMIN_PASSWORD and restart the server.
          </div>
        </div>
      </section>

      <!-- LIST -->
      <section class="card card-pad" style="margin-top:14px;">
        <div class="row" style="justify-content:space-between;">
          <div class="section-title">üìã Registered Players</div>
          <div class="row">
            <input id="filter" class="input" placeholder="Search nickname or ID‚Ä¶" />
            <button id="refreshBtn" class="btn" type="button">Refresh</button>
          </div>
        </div>

        <div id="countText" class="muted small" style="margin-top:10px;">Loading‚Ä¶</div>
        <div id="list" class="players"></div>
      </section>
    </div>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite">
    <div id="toastTitle" class="t1"></div>
    <div id="toastBody" class="t2"></div>
  </div>

  <script src="admin.js"></script>
</body>
</html>
